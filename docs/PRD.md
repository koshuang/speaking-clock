# 語音報時器 - 產品需求文件 (PRD)

## 1. 產品概述

### 1.1 產品名稱
語音報時器 (Speaking Clock)

### 1.2 產品定位
一款可安裝的網頁應用程式（PWA），提供定時語音報時功能，幫助用戶在專注工作或日常生活中掌握時間。

### 1.3 目標用戶
- 需要定時提醒時間的工作者
- 視力不便需要語音報時的用戶
- 希望減少看手機頻率的用戶
- 需要時間管理輔助的學生或專業人士

> 📋 **詳細 Persona 文件**：[docs/personas/](./personas/)
> - [小學一年級](./personas/elementary-grade1.md) - 剛開始學習時間觀念
> - [小學中年級（3-4年級）](./personas/elementary-grade3-4.md) - 培養自主管理
> - [小學高年級（5-6年級）](./personas/elementary-grade5-6.md) - 升學壓力與多任務管理
> - [家長](./personas/parent.md) - 設定監督與減少催促
> - [ADHD 用戶](./personas/adhd-user.md) - 時間盲與外部提醒需求

## 2. 功能需求

### 2.1 核心功能

#### 2.1.1 時間顯示
| 需求 | 描述 | 優先級 |
|------|------|--------|
| 即時時鐘 | 顯示當前日期與時間，每秒更新 | P0 |
| 日期格式 | 顯示年、月、日、星期（繁體中文） | P0 |
| 時間格式 | 24 小時制顯示 | P0 |

#### 2.1.2 語音報時
| 需求 | 描述 | 優先級 |
|------|------|--------|
| 定時報時 | 根據設定的間隔自動播報時間 | P0 |
| 時段區分 | 凌晨(00-05)、上午(06-11)、下午(12-17)、晚上(18-23) | P0 |
| 12 小時制播報 | 語音使用 12 小時制（如「下午 3 點」） | P0 |
| 整點特殊處理 | 整點播報「X 點整」，非整點播報「X 點 Y 分」 | P1 |
| 立即報時 | 提供按鈕可立即觸發報時 | P1 |

#### 2.1.3 報時設定
| 需求 | 描述 | 優先級 |
|------|------|--------|
| 啟用/停用 | 可開關報時功能 | P0 |
| 間隔設定 | 支援 1、5、10、15、30、60 分鐘間隔 | P0 |
| 語音選擇 | 可選擇系統可用的語音 | P1 |
| 預設語音 | 優先使用台灣繁體中文 (zh-TW) 語音 | P1 |
| 設定記憶 | 使用 localStorage 保存用戶設定 | P0 |

#### 2.1.4 螢幕常亮
| 需求 | 描述 | 優先級 |
|------|------|--------|
| Wake Lock | 支援 Screen Wake Lock API 防止螢幕關閉 | P1 |
| 開關控制 | 用戶可自行開啟或關閉螢幕常亮 | P1 |
| 自動恢復 | 頁面重新可見時自動恢復 Wake Lock | P2 |
| 狀態同步 | 追蹤用戶意圖與實際狀態，確保一致性 | P2 ✅ |

#### 2.1.5 使用者體驗（v1.1.0 新增）
| 需求 | 描述 | 優先級 |
|------|------|--------|
| 視覺回饋 | 報時時時鐘卡片脈動動畫 | P1 ✅ |
| 下次報時顯示 | 頁尾顯示下次報時時間 | P1 ✅ |
| 語音載入狀態 | 載入語音時顯示「載入中...」 | P2 ✅ |
| 深色模式 | 支援淺色/深色/系統主題切換 | P1 ✅ |
| 友善語音名稱 | 顯示「台灣」「中國」等區域標籤 | P2 ✅ |
| 點擊報時 | 點擊時鐘卡片觸發報時 | P2 ✅ |
| 間隔選擇指示 | 已選間隔顯示打勾圖示 | P2 ✅ |
| 新手導覽 | 首次使用顯示功能介紹覆蓋層 | P2 ✅ |

#### 2.1.6 無障礙支援（v1.1.0 新增）
| 需求 | 描述 | 優先級 |
|------|------|--------|
| ARIA 標籤 | 所有控制項皆有適當的 aria-label | P1 ✅ |
| 鍵盤支援 | 時鐘卡片支援 Enter/Space 觸發 | P1 ✅ |

#### 2.1.7 待辦提醒（v1.2.0 新增）
| 需求 | 描述 | 優先級 |
|------|------|--------|
| 待辦清單 | 新增、編輯、刪除待辦事項 | P1 ✅ |
| 語音提醒 | 報時後播報「提醒您：[待辦內容]」 | P1 ✅ |
| 完成標記 | 點擊打勾標記完成，切換到下一個 | P1 ✅ |
| 拖曳排序 | 拖曳調整順序決定提醒優先級 | P1 ✅ |
| 視覺提示 | 高亮顯示下一個將被提醒的項目 | P2 ✅ |
| 資料持久化 | 使用 localStorage 儲存待辦清單 | P0 ✅ |
| 圖示選擇 | 可為待辦選擇圖示（60+圖示、13類別） | P1 ✅ |
| 分類標籤 | 圖示依類別分組（上學、學習、美術等） | P2 ✅ |

#### 2.1.8 任務計時器（v1.4.0 新增）
| 需求 | 描述 | 優先級 |
|------|------|--------|
| 時長設定 | 可為待辦設定執行時長（5/10/15/20/30/45/60 分鐘） | P1 ✅ |
| 計時控制 | 開始、暫停、恢復、完成任務計時 | P1 ✅ |
| 進度顯示 | 顯示剩餘時間和進度條 | P1 ✅ |
| 開始播報 | 開始時播報「{時間}，現在是{任務}時間，共 X 分鐘」 | P1 ✅ |
| 報時整合 | 報時時自動播報進行中任務剩餘時間 | P1 ✅ |
| 完成播報 | 任務完成時播報「{任務}，時間到了。做得好！」 | P1 ✅ |
| 下一任務 | 完成後播報下一個有時長的待辦 | P2 ✅ |
| 狀態持久化 | 使用 sessionStorage 保存計時狀態（頁面關閉清除） | P1 ✅ |
| 12小時制 | 播報時間使用 12 小時制（如「下午 2 點」） | P1 ✅ |

#### 2.1.9 兒童友善功能（v1.8.0 新增）
| 需求 | 描述 | 優先級 |
|------|------|--------|
| 兒童模式開關 | 設定中可開啟兒童模式 | P1 ✅ |
| 大按鈕 | 兒童模式下按鈕和文字放大 | P1 ✅ |
| 慢速語音 | 兒童模式下語速降至 0.8x | P1 ✅ |
| 慶祝音效 | 任務完成時播放慶祝音效（Web Audio API） | P1 ✅ |
| 紙屑動畫 | 任務完成時顯示五彩紙屑動畫 | P1 ✅ |
| 鼓勵語 | 任務完成時語音播報中文鼓勵語（6種隨機） | P1 ✅ |
| 快速任務模板 | 提供 22 種預設常用任務（日常、學習、自我照顧、遊戲） | P1 ✅ |
| 模板選擇器 | 下拉選單依分類顯示模板，點擊快速新增 | P1 ✅ |
| 主人公名字 | 可設定小朋友名字，提醒時先念名字再唸任務 | P1 ✅ |

**預設任務模板（22種）：**
| 分類 | 任務 |
|------|------|
| 日常 | 吃早餐、吃午餐、吃晚餐、收玩具、整理書包、整理房間、摺衣服、澆花、擺碗筷、倒垃圾 |
| 學習 | 寫功課、看書閱讀、練鋼琴、學英文 |
| 自我照顧 | 刷牙洗臉、準備睡覺、穿衣服 |
| 遊戲 | 自由玩耍、戶外活動、畫畫、玩平板、玩手機 |

### 2.2 PWA 功能

| 需求 | 描述 | 優先級 |
|------|------|--------|
| 可安裝 | 支援安裝到桌面或手機主畫面 | P0 |
| 離線支援 | 安裝後可離線使用 | P1 |
| Service Worker | 使用 Workbox 管理快取策略 | P1 |
| 安裝提示 | 自動顯示安裝提示橫幅 | P2 ✅ |

## 3. 技術規格

### 3.1 技術架構

採用 Clean Architecture 分層架構：

```
src/
├── domain/           # 核心業務邏輯（無外部依賴）
│   ├── entities/     # 資料模型
│   ├── usecases/     # 應用邏輯
│   └── ports/        # 介面定義
├── infrastructure/   # 外部依賴實作
├── presentation/     # UI 層
└── di/               # 依賴注入
```

### 3.2 技術選型

| 類別 | 技術 | 說明 |
|------|------|------|
| 框架 | React 19 | UI 框架 |
| 建置工具 | Vite 7 | 快速開發與建置 |
| 語言 | TypeScript | 型別安全 |
| UI 元件庫 | shadcn/ui | 可客製化的 UI 元件 |
| 圖示庫 | lucide-react | 開源 SVG 圖示集（60+ 圖示） |
| 拖曳排序 | dnd-kit | 無障礙拖曳排序套件 |
| 樣式 | Tailwind CSS v4 | Utility-first CSS 框架 |
| PWA | vite-plugin-pwa | Service Worker 與 Manifest |
| 測試 | Vitest | 單元測試 |
| 部署 | GitHub Pages | 靜態網站託管 |

### 3.3 瀏覽器 API

| API | 用途 | 支援度 |
|-----|------|--------|
| Web Speech API | 語音合成 | 現代瀏覽器皆支援 |
| Screen Wake Lock API | 防止螢幕關閉 | Chrome, Edge, Safari |
| Web Audio API | 播放慶祝音效 | 現代瀏覽器皆支援 |
| localStorage | 儲存設定與待辦 | 所有瀏覽器 |
| sessionStorage | 儲存進行中任務狀態 | 所有瀏覽器 |

## 4. 使用者介面

### 4.1 頁面結構（v1.5.0 重構）

採用底部標籤導航，手機用戶無需滾動即可切換功能：

```
┌─────────────────────────────┐
│      語音報時器          ☀️  │  Header（固定）
├─────────────────────────────┤
│      2024年1月1日 星期一      │
│          10:30:45           │  時鐘（永遠可見）
│      下次報時：10:45         │
├─────────────────────────────┤
│                             │
│      （依標籤顯示內容）        │  動態內容區
│                             │
├─────────────────────────────┤
│   🕐 時鐘  │  📋 待辦  │  ⚙️ 設定  │  底部導航（固定）
└─────────────────────────────┘
```

**標籤內容：**
- **時鐘**：操作提示
- **待辦**：待辦清單與任務計時器
- **設定**：報時狀態、螢幕常亮、間隔、語音選擇

### 4.2 互動流程

1. 用戶開啟應用，顯示當前時間
2. 點擊底部「設定」標籤，啟用報時並選擇間隔
3. 點擊「待辦」標籤新增待辦事項
4. 系統在指定間隔自動播報時間和待辦提醒
5. 用戶可隨時點擊時鐘卡片立即報時

## 5. 非功能需求

### 5.1 效能
- 首次載入時間 < 3 秒
- 時鐘更新不造成明顯卡頓

### 5.2 可用性
- 響應式設計，支援手機與桌面
- 按鈕足夠大，方便觸控操作

### 5.3 可靠性
- 設定自動保存，重新開啟不遺失
- 語音 API 不支援時顯示提示

### 4.3 待辦提醒區（v1.2.0 新增）

```
┌─────────────────────────────┐
│  📋 待辦提醒                 │
│  報時後會語音提醒下一個待辦   │
├─────────────────────────────┤
│  [😊▼][輸入待辦事項...] [+]  │
├─────────────────────────────┤
│  ⋮⋮ ☐ 🎒 上學 (下次提醒) ✏️🗑️ │
│  ⋮⋮ ☑ 🎹 練琴           ✏️🗑️ │
│  ⋮⋮ ☐ 📖 寫功課         ✏️🗑️ │
└─────────────────────────────┘
```

## 6. 未來規劃

| 功能 | 描述 | 優先級 |
|------|------|--------|
| 自訂報時文字 | 允許用戶自訂報時模板 | P2 |
| 音效提示 | 報時前播放提示音 | P2 |
| 多語言支援 | 支援英文等其他語言介面 | P3 |
| 排程報時 | 設定特定時段才報時 | P3 |
